<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guest List â€” Event Management</title>
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
  <nav class="navbar">
    <span class="brand">ðŸŽ‰ Event Management</span>
    <nav>
      <a href="user-portal.html">Home</a>
      <a href="cart.html">Cart</a>
      <a href="order-status.html">Order Status</a>
    </nav>
    <button class="btn-logout" onclick="logout('user')">Log Out</button>
  </nav>

  <div class="container">
    <div class="card">
      <div class="flex-between mb-2">
        <h2>ðŸ‘¥ Guest List</h2>
        <button class="btn btn-primary btn-sm" onclick="addGuest()">+ Add Guest</button>
      </div>
      <div id="alert-box"></div>

      <div id="guestFormSection" class="card hidden" style="background:#f8fafc;margin-bottom:1rem;">
        <div class="grid-2">
          <div class="form-group">
            <label>Guest Name</label>
            <input type="text" id="gName" placeholder="Full name" />
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="gEmail" placeholder="Email address" />
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" id="gPhone" placeholder="Phone number" />
          </div>
          <div class="form-group">
            <label>RSVP</label>
            <select id="gRsvp">
              <option value="Pending">Pending</option>
              <option value="Confirmed">Confirmed</option>
              <option value="Declined">Declined</option>
            </select>
          </div>
        </div>
        <button class="btn btn-primary btn-sm" onclick="saveGuest()">Save Guest</button>
        <button class="btn btn-outline btn-sm" onclick="closeGuestForm()">Cancel</button>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>#</th><th>Name</th><th>Email</th><th>Phone</th><th>RSVP</th><th>Action</th></tr>
          </thead>
          <tbody id="guestTable">
            <tr><td colspan="6" class="text-muted text-center">No guests added yet. Click "+ Add Guest" to begin.</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="../js/main.js"></script>
  <script>
    let guests = JSON.parse(localStorage.getItem('guestList') || '[]');

    function renderGuests() {
      const tbody = document.getElementById('guestTable');
      if (!guests.length) {
        tbody.innerHTML = '<tr><td colspan="6" class="text-muted text-center">No guests added yet.</td></tr>'; return;
      }
      tbody.innerHTML = guests.map((g, i) => `
        <tr>
          <td>${i + 1}</td>
          <td>${g.name}</td>
          <td>${g.email}</td>
          <td>${g.phone}</td>
          <td><span class="badge ${g.rsvp === 'Confirmed' ? 'badge-green' : g.rsvp === 'Declined' ? 'badge-red' : 'badge-yellow'}">${g.rsvp}</span></td>
          <td><button class="btn btn-danger btn-sm" onclick="removeGuest(${i})">Remove</button></td>
        </tr>
      `).join('');
    }

    function addGuest() { document.getElementById('guestFormSection').classList.remove('hidden'); }
    function closeGuestForm() { document.getElementById('guestFormSection').classList.add('hidden'); }

    function saveGuest() {
      const name  = document.getElementById('gName').value.trim();
      const email = document.getElementById('gEmail').value.trim();
      const phone = document.getElementById('gPhone').value.trim();
      const rsvp  = document.getElementById('gRsvp').value;
      if (!name || !email) return showAlert('Name and email are required.');
      guests.push({ name, email, phone, rsvp });
      localStorage.setItem('guestList', JSON.stringify(guests));
      closeGuestForm();
      document.getElementById('gName').value = '';
      document.getElementById('gEmail').value = '';
      document.getElementById('gPhone').value = '';
      renderGuests();
    }

    function removeGuest(i) {
      guests.splice(i, 1);
      localStorage.setItem('guestList', JSON.stringify(guests));
      renderGuests();
    }

    renderGuests();
  </script>
</body>
</html>
